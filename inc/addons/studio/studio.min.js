"use strict";window.alpus_vc_studio_delay=1500,window.themeCoreAdmin||(window.themeCoreAdmin={}),function(e){themeCoreAdmin.selectBlock=function(){var t=e(this),a=e(this).parent().data("category");parseInt(a)?a%23==1?e(".alpus-new-template-form .template-type").val("header"):a%23==2?e(".alpus-new-template-form .template-type").val("footer"):a%23==3?e(".alpus-new-template-form .template-type").val("popup"):a%23==4?e(".alpus-new-template-form .template-type").val("single"):a%23==5?e(".alpus-new-template-form .template-type").val("archive"):a%23==6?e(".alpus-new-template-form .template-type").val("shop"):a%23==7?e(".alpus-new-template-form .template-type").val("product_layout"):a%23==8?e(".alpus-new-template-form .template-type").val("cart"):a%23==9?e(".alpus-new-template-form .template-type").val("checkout"):a%23==10?e(".alpus-new-template-form .template-type").val("type"):e(".alpus-new-template-form .template-type").val("block"):e(".alpus-new-template-form .template-type").val(a),e(".blocks-wrapper .block.selected").removeClass("selected"),e("#alpus-new-template-id").val(t.parent().data("id")),e(".blocks-wrapper .block-category-my-templates.active").length?e("#alpus-new-template-type").val("my"):(e("#alpus-elementor-studio").is(":checked")?e("#alpus-new-template-type").val("e"):e("#alpus-wpbakery-studio").is(":checked")&&e("#alpus-new-template-type").val("w"),"type"==e(".alpus-new-template-form .template-type").val()&&e("#alpus-new-template-type").val("g")),e("#alpus-new-template-name").val(t.closest(".block").addClass("selected").find(".block-title").text()),e(".blocks-wrapper, .blocks-overlay").addClass("closed")};var t=!1;function a(){var a="",l="e";!function(){e("#alpus_studio_blocks_wrapper_template").after(e("#alpus_studio_blocks_wrapper_template").text()).remove(),e(".blocks-wrapper .blocks-list").length&&e(document.body).on("click",".blocks-wrapper .category-list a",m).on("click",".blocks-list .import",g).on("click",".blocks-wrapper .blocks-list .select",themeCoreAdmin.selectBlock).on("click",".blocks-list .favourite",h).on("click",".blocks-wrapper .mfp-close, .blocks-overlay",k).on("click",".blocks-wrapper .block-category",w).on("keydown",".blocks-wrapper input",f).on("submit",".blocks-wrapper .demo-filter form",b).on("click","#vc_button-update",u).on("change","#alpus-elementor-studio",v).on("change","#alpus-wpbakery-studio",v).on("click",".blocks-wrapper a.section-switch",y);e(".blocks-wrapper img[data-original]").each((function(){e(this).attr("src",e(this).data("original")),e(this).removeAttr("data-original")})),e(".blocks-wrapper").imagesLoaded((function(){setTimeout((function(){e(".blocks-wrapper .blocks-list").hasClass("initialized")||(e(".blocks-wrapper .blocks-list").addClass("initialized").isotope({itemSelector:".block",layoutMode:"masonry"}),e(".blocks-wrapper .blocks-section").on("scroll",(function(){var t=e(this),l=t.closest(".blocks-wrapper");if(l.length){var o=t.children().offset().top+t.children().height()-t.offset().top-t.height(),i=parseInt(l.find(".category-list a.active").data("total-page"),10),s=!1;if(a&&l.find(".category-list a.active").hasClass("all")&&(s=!0,i=parseInt(l.find(".category-list .filtered a").data("total-page"),10)),o<=10&&!l.hasClass("loading")&&i>=r+1){var n=l.find(".category-list a.active").data("filter-by");a||parseInt(n,10)||"blocks"==n||"*"==n||"my"==n?s?l.find(".category-list .filtered>a").trigger("click",[r+1,!!a]):l.find(".category-list a.active").trigger("click",[r+1,!!a]):"all"!=n&&l.find(".demo-filter .btn").trigger("click",[r+1])}}})),e(".blocks-wrapper .blocks-section").trigger("scroll")),e(".blocks-wrapper .blocks-list").isotope("layout")}),100)}))}(),e(document.body).find("#wpb_visual_composer").length>0&&(l="w"),e(document.body).hasClass("vc_inline-shortcode-edit-form")&&(l="w"),e(document.body).hasClass("block-editor-page")&&(l="g");var o,i,s,n,r=1;function c(t,a){if(t&&t.content)if("undefined"!=typeof vc&&vc.storage)vc.storage.append(t.content),vc.shortcodes.fetch({reset:!0}),_.delay((function(){window.vc.undoRedoApi.unlock()}),50);else if(window.vc_iframe_src){var l={action:"vc_frontend_load_template",block_id:a,content:t.content,wpnonce:alpus_studio.wpnonce,template_unique_id:"1",template_type:"my_templates",vc_inline:!0,_vcnonce:window.vcAdminNonce};t.meta&&(l.meta=t.meta),e.ajax({url:window.vc_iframe_src.replace(/&amp;/g,"&"),type:"post",data:l,success:function(t){var a,l;_.each(e(t),(function(e){if("vc_template-data"===e.id)try{l=JSON.parse(e.innerHTML)}catch(e){}"vc_template-html"===e.id&&(a=e.innerHTML)})),a&&l&&(vc.builder.buildFromTemplate(a,l),vc.closeActivePanel())}})}t&&t.meta&&(t.meta.page_css&&e(".postbox-container #wpb_visual_composer").length>0&&(e("#vc_post-custom-css").val(e("#vc_post-custom-css").val()+t.meta.page_css),e("#vc_ui-panel-post-settings").css("display","none"),e("#vc_post-settings-button").trigger("click"),e("#vc_ui-panel-post-settings .vc_ui-panel-footer .vc_ui-button-fw").trigger("click"),e("#vc_ui-panel-post-settings").css("display","")),t.meta.page_js&&e("#page_js").length>0&&e("#page_js").val(e("#page_js").val()+t.meta.page_js),window.vc_iframe_src&&(void 0===alpus_studio.meta_fields&&(alpus_studio.meta_fields={}),t.meta.page_css&&(e("#vc_post-custom-css").val(e("#vc_post-custom-css").val()+t.meta.page_css),e("#vc_ui-panel-post-settings").css("display","none"),e("#vc_post-settings-button").trigger("click"),e("#vc_ui-panel-post-settings .vc_ui-panel-footer .vc_ui-button-fw").trigger("click"),e("#vc_ui-panel-post-settings").css("display","")),t.meta.page_js&&(void 0===alpus_studio.meta_fields.page_js&&(alpus_studio.meta_fields.page_js=""),-1===alpus_studio.meta_fields.page_js.indexOf(t.meta.page_js)&&(alpus_studio.meta_fields.page_js+=t.meta.page_js)))),t&&t.error&&alert(t.error)}function p(a){if(a){if(a.content){var l=function(e){Array.isArray(e)&&e.forEach((function(t,a){t.elements&&l(t.elements),t.elType&&(e[a].id=elementorCommon.helpers.getUniqueId())}))};if(Array.isArray(a.content)){var o=!0;a.content.forEach((function(e){if("widget"!=e.elType)return o=!1,!1})),o?a.content=[{elType:"section",elements:[{elType:"column",elements:a.content}]}]:a.content.forEach((function(e,t){"widget"==e.elType?a.content[t]={elType:"section",elements:[{elType:"column",elements:e}]}:"column"==e.elType&&(a.content[t]={elType:"section",elements:e})}))}l(a.content),elementor.getPreviewView().addChildModel(a.content,t&&t.parent().hasClass("elementor-section-wrap")?(t.find(".elementor-add-section-close").trigger("click"),{at:t.index()}):{}),elementor.saver&&elementor.saver.footerSaver&&elementor.saver.footerSaver.activateSaveButtons?elementor.saver.footerSaver.activateSaveButtons(document,"publish"):$e.run("document/save/publish")}if(a.meta)for(var i in a.meta){var s=a.meta[i].replace("/<script.*?/script>/s",""),n=elementor.settings.page.model.get(i);void 0===n&&(n=""),n&&-1!==n.indexOf(s)||elementor.settings.page.model.set(i,n+s),"page_css"==i&&(elementorFrontend.hooks.doAction("refresh_page_css",n+s),e('textarea[data-setting="page_css"]').val(n+s))}a.error&&alert(a.error)}}function d(t){if(t){if(t.content){var a=wp.blocks.parse(t.content);if(a&&a.length)wp.data.dispatch("core/block-editor").insertBlocks(a)}if(t.meta){var l=e("#page_css"),o=e("#page_js");t.meta.page_css&&(l.val(l.val()+"\r\n"+t.meta.page_css),l.trigger("change")),t.meta.page_js&&(o.val(o.val()+"\r\n"+t.meta.page_js),o.trigger("change"))}t.error&&alert(t.error)}}function m(t,o,i,s=""){t.preventDefault();if(e(".blocks-wrapper").hasClass("loading"))return!1;var n=e(this),c=e('.blocks-wrapper .demo-filter input[type="search"]');if("I"==t.target.tagName)return n.siblings("ul").stop().slideToggle(200),n.children("i").toggleClass(e(t.target).data("toggle")),!1;if(n.hasClass("active")&&!n.parent().hasClass("filtered")&&(void 0===o||1==o)&&c.val()==a)return!1;a=i?c.val():"";var p=e(".blocks-wrapper .blocks-list"),d=e(".blocks-wrapper .block-categories"),m=e("#alpus-studio-candidate-blocks");if(m.length&&"widget-search"==s&&m.hasClass("loading"))return!1;if(void 0!==n.data("filter-by")||n.parent(".filtered").length){if((r=void 0===o?1:parseInt(o,10))>1){if(!d.hasClass("hide"))return;e(".blocks-wrapper").addClass("infiniteloading")}d.hasClass("hide")||(p.isotope("remove",p.children()),d.addClass("hide")),p.siblings(".coming-soon").remove();var g=n.data("filter-by"),h=null!=typeof n.data("title")?n.data("title"):"",u={action:"alpus_studio_filter_category",category_id:"widget-search"==s?0:g,wpnonce:alpus_studio.wpnonce,page:r,type:l,search:a};e(document.body).hasClass("elementor-editor-active")||e(document.body).hasClass("vc_inline-shortcode-edit-form")||e(document.body).find("#wpb_visual_composer").length>0||e(document.body).hasClass("block-editor-page")||(u.new_template=!0),e(".blocks-wrapper .block-category-favourites.active").length&&r>1&&(u.current_count=p.data("isotope").items.length),e(".blocks-wrapper").addClass("loading"),"widget-search"==s&&m.addClass("loading"),e("#alpus-studio-candidate-blocks").length||e("#elementor-panel-elements-wrapper").addClass("infiniteloading"),e.ajax({url:ajaxurl,type:"post",dataType:"html",data:u,success:function(t){if(e("#elementor-panel-elements-wrapper").removeClass("infiniteloading"),"error"==t)return e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading"),void m.removeClass("loading").removeClass("infiniteloading");var l=e(t),o=l.filter("#total_pages").text();o&&n.data("total-page",parseInt(o,10));var i=l=l.filter(".block");if("widget-search"==s)m.length?m.append(i.clone()):e("#elementor-panel-elements-wrapper").append(i.clone().wrapAll('<div class="blocks-list" id="alpus-studio-candidate-blocks"></div>').parent()),e("#alpus-studio-candidate-blocks").removeClass("loading").removeClass("infiniteloading");else{let t="";e("#elementor-panel-elements-search-input").length&&(t=e("#elementor-panel-elements-search-input").val()),m.length&&e(".demo-filter input[type=search]").val()==t&&m.append(i.clone())}if(1===r&&(p.isotope("remove",p.children()),"widget-search"==s&&p.children().remove()),e(".blocks-wrapper .category-list a").removeClass("active"),n.parent().hasClass("category-has-children")){var c=n.children("i"),d=n.siblings("ul");c.hasClass(c.data("toggle").split(" ")[0])||(d.stop().slideDown(200),c.toggleClass(c.data("toggle"))),d.find("li a").removeClass("active"),d.find("li:first-child a").addClass("active")}else n.parent().hasClass("filtered")?n.parent().siblings().find(".all").addClass("active"):n.addClass("active");l.imagesLoaded((function(){"widget-search"!=s?p.append(l).isotope("appended",l).isotope("layout"):p.children().css({"transition-duration":""}),e(".block").each((function(){e(this).find(".block-inner-img-wrapper").outerHeight()>=e(this).find("img").outerHeight()&&e(this).find(".block-img-wrapper").addClass("block-img-fixed")})),e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading"),e(".blocks-wrapper .blocks-section").trigger("scroll")})),p.attr("class","blocks-list column-3"+(h?" "+h:"")+(a?" "+a:""))}}).fail((function(){alert(alpus_studio.texts.loading_failed),e(".blocks-wrapper").removeClass("loading").removeClass("infiniteloading"),m.removeClass("loading").removeClass("infiniteloading")}))}else n.hasClass("all")?(d.removeClass("hide"),p.siblings(".coming-soon").remove()):(d.addClass("hide"),p.isotope("remove",p.children()).css("height",""),p.siblings(".coming-soon").length||p.before('<div class="coming-soon">'+alpus_studio.texts.coming_soon+"</div>")),e(".blocks-wrapper .category-list a").removeClass("active"),n.addClass("active")}function g(e){e.preventDefault(),themeAdmin.prompt.showDialog({title:alpus_studio.pro_title,content:alpus_studio.pro_desc,actions:[{callback:function(){window.open(alpus_studio.purchase_pro)}},{callback:""}]})}function h(){var t=e(this),a=t.closest(".block").addClass("doing"),o=e(".blocks-wrapper .blocks-list"),i=e(".blocks-wrapper .block-category-favourites span"),s={action:"alpus_studio_favour_block",wpnonce:alpus_studio.wpnonce,block_id:t.parent().data("id"),type:l,active:a.hasClass("favour")?0:1};e(".blocks-wrapper .block-category-favourites.active").length&&(s.current_count=o.data("isotope").items.length),e.post(ajaxurl,s,(function(t){a.toggleClass("favour");var l=parseInt(i.text().replace("(","").replace(")",""))+(a.hasClass("favour")?1:-1);if(i.text("("+l+")").parent().data("total-page",Math.ceil(l/alpus_studio.limit)),void 0!==s.current_count){var n=e(t);o.isotope("remove",a),t&&t.trim()&&o.append(n).isotope("appended",n),o.isotope("layout"),r=Math.ceil(s.current_count/alpus_studio.limit)}})).always((function(){a.removeClass("doing")}))}function u(t){0==e(".postbox-container #wpb_visual_composer").length&&alpus_studio.meta_fields&&vc_post_id&&e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"alpus_studio_save",post_id:vc_post_id,nonce:alpus_studio.wpnonce,fields:alpus_studio.meta_fields}})}function v(){e(".blocks-wrapper .block.selected").removeClass("selected"),e("#alpus-new-template-id").val(""),e("#alpus-new-template-type").val(""),e("#alpus-new-template-name").val("")}function f(t){13==t.keyCode&&e(this).closest("form").trigger("submit")}function b(t,a,l=""){t.preventDefault();var o=e(this);void 0===a&&(a=1);var i=e(".blocks-wrapper .category-list a.active");o.find('input[type="search"]').val()||i.length?i.length&&!i.hasClass("all")?i.trigger("click",[a,!0,l]):e(".blocks-wrapper .filtered>a").trigger("click",[a,!0,l]):e(".blocks-wrapper .all").trigger("click"),o.attr("disabled","disabled")}function w(t){this.getAttribute("data-category")&&e(".blocks-wrapper .block-category-"+this.getAttribute("data-category")).trigger("click"),t.preventDefault()}function k(){e(".blocks-wrapper, .blocks-overlay").addClass("closed")}function y(t){t.preventDefault();var a=e(this),l=e(a.attr("href"));l.length&&!a.hasClass("active")&&(a.siblings(".active").removeClass("active"),a.addClass("active"),l.siblings(".active").removeClass("active"),l.addClass("active"))}e(".blocks-wrapper").length&&(e("#elementor-panel").on("mousewheel","#elementor-panel-content-wrapper",(function(){var t=e("#alpus-studio-candidate-blocks");if(t.length&&e(".demo-filter input[type=search]").val()&&(t.offset().top-e(this).offset().top+t.height()-e(this).height()<=10&&!t.hasClass("loading"))){var a=e(".blocks-wrapper");if(a.length){var l=parseInt(a.find(".category-list a.active").data("total-page"),10),o=!1;a.find(".category-list a.active").hasClass("all")&&(o=!0,l=parseInt(a.find(".category-list .filtered a").data("total-page"),10)),l>=r+1&&(o?a.find(".category-list .filtered>a").trigger("click",[r+1,!0,"widget-search"]):a.find(".category-list a.active").trigger("click",[r+1,!0,"widget-search"]),t.addClass("infiniteloading"))}}})),e("body").on("mouseenter","#elementor-panel-inner #alpus-studio-candidate-blocks > .block",(function(t){var a=e(this),l=a.find("img"),o=a.find(".block-title");e("body").find(".candidate-preivew").length||e("#elementor-panel-inner").prepend('<div class="candidate-preivew"><figure class="candidate-preview-image"></figure><div class="candidate-preview-title"></div></div>'),e(".candidate-preview-image").empty().prepend(l.clone()),e(".candidate-preview-title").empty().prepend(o.clone()),e(".candidate-preivew").addClass("active"),setTimeout((function(){e(".candidate-preview-image").delay(300).addClass("active")}),100)})).on("mouseleave","#elementor-panel-inner #alpus-studio-candidate-blocks > .block",(function(t){e(".candidate-preivew").removeClass("active"),e(".candidate-preview-image").removeClass("active")}))),e(document.body).on("click","#alpus-elementor-panel-alpus-studio, #vce-alpus-studio-trigger, #wpb-alpus-studio-trigger, #gutenberg-alpus-studio-trigger",(function(e){e.preventDefault(),themeAdmin.prompt.showDialog({title:alpus_studio.pro_title,content:alpus_studio.pro_desc,actions:[{callback:function(){window.open(alpus_studio.purchase_pro)}},{callback:""}]})})).on("click","#alpus-new-studio-trigger",(function(e){themeAdmin.prompt.showDialog({title:alpus_studio.pro_title,content:alpus_studio.pro_desc,actions:[{callback:function(){window.open(alpus_studio.purchase_pro)}},{callback:""}]})})),alpus_studio.start_template&&(o=parseInt(alpus_studio.start_template),n=e.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"alpus_studio_import",block_id:o,wpnonce:alpus_studio.wpnonce,type:l,mine:"my"==e(".blocks-wrapper .category-list a.active").data("filter-by")},success:function(e){"e"==l?p(e):"w"===l?c(e,o):d(e),s&&s.addClass("imported")},failure:function(){alert(alpus_studio.texts.importing_error)}}),i&&n.always(i)),alpus_studio.start_template_content&&("e"==l?p(alpus_studio.start_template_content):"w"==l?c(alpus_studio.start_template_content):d(alpus_studio.start_template_content)),setTimeout((function(){e("#editor .edit-post-header-toolbar__left").append('<span id="gutenberg-alpus-studio-trigger" class="components-button has-icon is-primary" title="'+alpus_studio.texts.theme_display_name+' Studio"><i class="alpus-mini-logo"></i></span>')}),100)}e(document).ready((function(){e(document.body).hasClass("elementor-editor-active")&&"undefined"!=typeof elementor&&(window.runStudio=function(a){e("#alpus-elementor-panel-alpus-studio").trigger("click"),a&&(t=e(a).closest(".elementor-add-section"))},elementor.on("document:loaded",a))})),e(window).on("load",(function(){e(document.body).hasClass("elementor-editor-active")&&"undefined"!=typeof elementor||a()}))}(jQuery);